%
% 1-fundamtenallemma.tex
%
% (c) 2023 Prof Dr Andreas Müller
%
\section{Das Fundamentallemma für Funktionen mehrere Variablen
\label{buch:felder:section:fundamentallemma}}
\kopfrechts{Das Fundamentallemma}
Der Schlüssel für die Umwandlung eines eindimensionalen Variationsproblems
in eine Differentialgleichung war das Fundamentallemma.

%
% Gebiete
%
\subsection{Gebiete}
Variationsprobleme für Funktionen von nur einer Variablen sind auf 
Funktionen auf einem Intervall beschränkt.
Besteht der Definitionsbereich aus mehreren Intervallen, kann jedes
einzelne Intervall unabhängig von allen anderen betrachtet werden.
Für ein Intervall $[x_0,x_1]$ ist auch das Integral einfach zu definieren,
wie es zur Konstruktion des zu minimierenden Funktionals nötig ist.

Für Funktionen von zwei oder mehr Variablen ist bereits die
Festlegung des Definitionsgebietes viel komplizierter.
Sie muss so erfolgen, dass auch die partielle Integration eines
Produktes darauf übertragbar ist.
Diese wurde im eindimensionalen Fall dazu aus dem Integral
über $F\cdot\eta'$ eine Integral über $dF/dx\cdot \eta$ zu
machen, auf welches das Fundamentallemma anwendbar war.

%
% Offene Mengen
%
\subsubsection{Offene Mengen}
Die Ableitung einer Funktion $f$ in einem Punkt $x\in\mathbb{R}$ erfordert,
dass man Funktionswerte in $x$ mit Funktionswerten in Punkten $x+h$
vergleichen kann, wobei $h\in\mathbb{R}^n$ ein beliebiger kleiner Vektor
sein kann.
Die Ableitung einer Funktion ist dann definiert als die lineare
Ersatzfunktion $Df(x)$ mit der Eigenschaft
\[
f(x+h) = f(x) + Df(x)\cdot h + o(h).
\]
Die Ableitung kann also nur dann sinnvoll definiert werden, wenn
Funktion nicht nur im Punkt $x$, sondern auch in einer Umgebung
des Punktes $x$.
Die Ableitung einer Funktion ist daher nur definiert auf einer
offenen Menge im Sinne der folgenden Definition.

\begin{definition}[offene Menge, Gebiet]
Eine Teilmenge $\Omega\subset\mathbb{R}^n$ heisst {\em offen}, wenn es für
\index{offen}%
jeden Punkt $x\in\Omega$ eine $r>0$ gibt derart, dass ein
Ball mit Radius $r$ um den Punkt $x$ ebenfalls in $\Omega$ enthalten
ist:
\[
B_r(x)
=
\{y\in\mathbb{R}^n
\mid
|y-x|<r\}
\subset \Omega.
\]
Eine offene Menge $\Omega\subset\mathbb{R}$ heisst auch ein {\em Gebiet}.
\index{Gebiet}%
\end{definition}

%
% Der Rand eines Gebietes
%
\subsubsection{Der Rand eines Gebiets}
Die partielle Integration einer Funktion einer Variablen liefert
neben dem Integralterm auch einen Term, der nur von den Werten der
Funktionen an den Endpunkten des Intervalls abhängt.
Es ist zu erwarten, dass ein ähnliches Prinzip auch für die
Integration von Funktionen mehrere Variablen gilt.
Dazu ist jedoch nötig zu erklären, wie genau der Rand eines
Gebietes zu finden ist.

Der Rand eines Intervalls ist einfach zu finden.
Ein Endpunkt eines Intervalls hat die Eigenschaft, dass sich
auf der einen Seite des Punktes lauter Werte befinden, die zum
Intervall gehören, während auf der anderen Seite nur Werte liegen,
die nicht zum Intervall gehören.
Diese anschauliche Beschreibung appelliert aber an eine Vorstellung
einer Richtung und ist daher nicht direkt übersetzbar.
Sie lässt sich aber noch etwas vereinfachen: ein Endpunkt eines
Intervalls hat beliebig nahe Werte die zum Intervall gehören, und
solche die nicht mehr dazu gehören.
Dies suggeriert die folgende Definition für den Rand eines Gebietes.

\begin{definition}[Rand]
\label{buch:felder:fundamentallemma:def:rand}
Ein Randpunkt eines Gebietes $\Omega\subset\mathbb{R}^n$ ist ein Punkt
$x\in\mathbb{R}^n$ mit der Eigenschaft, dass in jeder noch so kleinen 
Umgebung von $x$ Punkte von $\Omega$ und von $\mathbb{R}^n\setminus\Omega$
liegen.
Ein Randpunkt ist also ein Punkt $x\in\mathbb{R}^n$ mit
\[
B_r(x)\cap \Omega\ne \emptyset
\qquad\text{und}\qquad
B_r(x)\cap (\mathbb{R}^n\setminus \Omega)
\ne \emptyset
\]
für alle $r>0$.
Der Rand $\partial \Omega$ eines Gebietes $\Omega$ ist die Menge
aller Randpunkte von $\Omega$.
\end{definition}

Man beachte, dass ein Gebiet $\Omega$ keine Randpunkte enthält.
Wäre $x$ ein Randpunkt von $\Omega$, dann gibt es einen Radius $r$
derart, dass $B_r(x)\in\Omega$ ist.
Für diesen Radius folgt
\[
B_r(x)\cap (\mathbb{R}^n\setminus\Omega)
=
\emptyset,
\]
im Widerspruch zu Annahme, dass $x$ ein Randpunkt war.
Der Widerspruch zeigt, dass ein Punkt von $\Omega$ kein Randpunkt
sein kann.

Die rein punktmengentopologische 
\input{chapters/040-felder/fig/mandelbrot.tex}%
Definition~\ref{buch:felder:fundamentallemma:def:rand} des Randes ist
auf Mengen anwendbar, deren Rand sehr kompliziert ist.
Ein Beispiel ist die Mandelbrot-Menge, die in
Abbildung~\ref{buch:felder:fundamentallemma:fig:mandelbrot}
dargestellt ist.
Der schwarze Bereich ist die Mandelbrot-Menge, die farbigen Bereich
liegen ausserhalb der Menge.
Der Rand ist berühmt dafür, dass man beliebig tief hineinzoomen
und immer neue Strukturen entdecken kann.


%
% Integration über ein Gebiet
%
\subsubsection{Integration über ein Gebiet}

%
% Integration über eine Kurve
%
\subsubsection{Integration über eine Kurve}

%
% Integration
%
\subsection{Partielle Integration}
Die partielle Integration für ein Integral einer Variablen
transformiert das Integral
\[
\int_{a}^{b} f(x) g'(x)\,dx
\]
in die Summe
\[
\biggl[ f(x) g(x) \biggr]_a^b
-
\int_a^b f'(x) g(x)\,dx.
\]
Der erste Term hängt nur von Informationen auf dem Rand des 
Definitionsbereichs ab.
Eine Verallgemeinerung dieser Regel muss vor allem auch klären,
wie dieser erste Term aussehen soll.
Er darf nur von den Funktionswerten der Funktionen auf dem Rand
$\partial\Omega$ abhängen.
Die Abhängigkeit muss ausserdem linear sein.
In diesem Abschnitt sollen in einer Folge von Beispielen die
wichtigsten Fälle systematisch entwickelt werden.

%
% Ableitung von Produkten
%
\subsubsection{Ableitung von Produkten}
Die Regel für die partielle Integration von Produkten von Funktionen
einer Variable ist die Integralform der Produktregel
\[
\frac{d}{dx}(f(x)g(x)) = f'(x)g(x) + f(x)g'(x).
\]
Für eine Erweiterung auf ist daher als erstes zu klären, welche Art
von Differentialoperatoren überhaupt in Frage kommen.

Die partielle Ableitung nach einer der Variablen bei Funktionen
$f$ und $g$ von $n$ Variablen erfüllt eine Produktregel:
\[
\frac{\partial}{\partial x_k}
(f(x)g(x))
=
\frac{\partial f}{\partial x_k}(x)\,g(x)
+
f(x)
\,
\frac{\partial g}{\partial x_k}(x)
\]
für jedes $k=1,\dots,n$.
Die partiellen Ableitungen sind aber nur von untergeordnetem Interesse,
da sie für sich allein von der Wahl des Koordinatensystems abhängig 
sind und daher zum Beispiel keine koordinatenunabhängige physikalische
Bedeutung haben können.

Der Gradient wurde aus der Richtungsableitung konstruiert und es wurde
gezeigt, dass 
\[
\operatorname{grad} f(x)
=
\begin{pmatrix}
\frac{\partial f}{\partial x_1}\\
\vdots\\
\frac{\partial f}{\partial x_n}
\end{pmatrix}
\]
eine koordinatenunabhängige Bedeutung als der Vektor hat, in dessen
Richtung die schnellste Zunahme der Funktion $f$ erfolgt.
Und tatsächlich gilt auch für den Gradienten eine Produktformel:
\begin{align*}
\operatorname{grad}(f(x)g(x))
&=
\begin{pmatrix}
\frac{\partial}{\partial x_1}(f(x)g(x))\\
\vdots\\
\frac{\partial}{\partial x_n}(f(x)g(x))
\end{pmatrix}
=
\begin{pmatrix}
\frac{\partial f}{\partial x_1} g(x)
+
f(x) \frac{\partial g}{\partial x_1}\\
\vdots\\
\frac{\partial f}{\partial x_n} g(x)
+
f(x) \frac{\partial g}{\partial x_n}
\end{pmatrix}
\\
&=
(\operatorname{grad}f(x)) g(x)
+
f(x)(\operatorname{grad}g(x))
\end{align*}

%
% Der Satz von Green
%
\subsubsection{Der Satz von Green}

%
% Der Satz von Gauss
%
\subsubsection{Der Satz von Gauss}

%
% Der Satz von Stokes
%
\subsubsection{Der Satz von Stokes}

%
% Glatte Funktionen mit kompaktem Träger
%
\subsection{Glatte Funktionen mit kompaktem Träger}

%
% Das Fundamentallemma für mehrere Variablen
%
\subsection{Das Fundamentallemma für mehrere Variablen}
Das Fundamentallemma war instrumental bei der Herleitung der
Euler-Lagrange-Differentialgleichung.
Es besagt, dass eine stetige Funktion von einer Variablen auf einem Intervall
verschwindet, wenn alle ihre Skalarprodukte mit beliebig of stetig
differenzierbaren Funktionen verschwinden.
Diese Eigenschaft gilt auch für Funktionen mehrerer Variablen und kann
ganz analog bewiesen werden.

\begin{satz}[Fundamentallemma]
Sei $\Omega\subset\mathbb{R}^n$ ein Gebiet und $f\colon \Omega\to\mathbb{F}$
eine stetige Funktion.
Ausserdem gelte für jede glatte Funktion $g\colon\Omega\to\mathbb{R}$ 
\begin{equation}
\int_{\Omega} f(x)g(x)\,dx = 0.
\label{buch:felder:fundamentallemma:eqn:bedfundamentallemma}
\end{equation}
Dann folgt $f(x)=0$.
\end{satz}

\begin{proof}
Wie im eindimensionalen Fall kann der Beweis mit einem Widerspruch
geführt werden.
Sei $(x^*_1,\dots,x^*_n)$ ein Punkt im Inneren des Gebietes $\Omega$,
für den $f(x^*_1,\dots,x^*_n)=a\ne 0$ ist.
Da die Funktion $f$ stetig ist, gibt es ein $\delta>0$ derart,
dass sogar
\[
f(x_1,\dots,x_n) > \frac{a}2
\qquad\text{für alle $x_i$ mit $|x_i-x^*_i|<\delta$.}
\]
Da $(x^*_1,\dots,x^*_n)$ im Inneren des Gebietes liegt, kann 
$\delta$ sogar so klein gewählt werden, dass alle Punkte
$(x_1,\dots,x_n)$ mit $|x^*_i-x_n|<\delta$ immer noch in
$\Omega$ liegen.

Sei $h(\xi)$ eine beliebig oft differenzierbare Funktion einer Variablen,
die nur im Intervall $(-\delta,\delta)$ von $0$ verschieden ist und
deren Integral über das Intervall $(-\delta,\delta)$ den Wert $1$ hat.
Mit der Funktion
\[
g(x_1,\dots,x_n)
=
h(x_1-x^*_1)\cdot\ldots\cdot h(x_n-x^*_n),
\]
deren Träger nach Konstruktion in $\Omega$ enthalten ist, wird jetzt das
Integral
\begin{align*}
\int_{\Omega} f(x)\,g(x)\,dx
&=
\int_{\operatorname{supp} g}
f(x)\,h(x_1-x^*_1)\cdots h(x_n-x^*_n)
\,dx_1,\dots,dx_n
\\
&>
\int_{x^*_1-\delta}^{x^*_1+\delta}
\dots
\int_{x^*_n-\delta}^{x^*_n+\delta}
\frac{a}{2}
h(x_n-x^*_n) \,dx_n
\,\dots
h(x_1-x^*_1) \,dx_1
\\
&=
\frac{a}2
\int_{x^*_1-\delta}^{x^*_1+\delta}
h(x_1-x^*_1) \,dx_1
\cdot
\ldots
\cdot
\int_{x^*_n-\delta}^{x^*_n+\delta}
h(x_n-x^*_n) \,dx_n
=
\frac{a}2>0.
\end{align*}
Mit dem konstruierten $g(x)$ ist also eine Funktion gefunden, die
Bedingung~\eqref{buch:felder:fundamentallemma:eqn:bedfundamentallemma}
des Fundamentallemmas nicht erfüllt.
Dieser Widerspruch zeigt, dass die Annahme, $f$ verschwinde nicht überall,
falsch ist.
Damit folgt, dass $f(x)=0$ ist.
\end{proof}



