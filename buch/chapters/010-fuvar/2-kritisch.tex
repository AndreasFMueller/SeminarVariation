%
% 2-kritisch.tex
%
% (c) 2023 Prof Dr Andreas Müller
%
\section{Kritische Punkte
\label{buch:fuvar:section:kritisch}}
\kopfrechts{Kritische Punkte}
In der Analysis der Funktionen einer Variablen lernt man, dass die
Nullstellen der Ableitung einer Funktion Kandidaten für die Extrema
sind.
Das Verschwinden der ersten Ableitung ist also eine notwendige Bedingung
für ein Minimum oder Maximum.
In diesem Abschnitt soll dieses Kriterium auf Funktionen mehrerer
Variablen übertragen werden.

%
% Das Verschwinden der ersten Ableitungen
%
\subsection{Notwendige Bedingung für Extrema
\label{buch:fuvar:subsection:kritisch}}
Wir betrachten eine stetig differenzierbare Funktion 
\[
f
\colon
\mathbb{R}^n\to\mathbb{R}
:
(x_1,\dots,x_n) \mapsto f(x_1,\dots,x_n) = f(x)
\]
und fragen nach den Extrema.
In einem Extremum $x^*\in\mathbb{R}^n$ wird auch jede der partiellen
Funktionen
\[
x_k \mapsto f(x_1^*,\dots,x_k,\dots,x_n^*)
\]
ein Extremum annehmen.
Es ist daher notwendig, dass auch die Ableitungen dieser partiellen
Funktionen Nullstellen in $x^*$ haben, es muss daher gelten
\begin{equation*}
\frac{\partial f}{\partial x_k}(x^*) = 0
\end{equation*}
für alle $k=1,\dots,n$.
Wir geben einem solchen Punkt $x^*$ einen speziellen Namen.

\begin{definition}[Kritischer Punkt]
Ist $f\colon \mathbb{R}^n\to\mathbb{R}$ eine stetig differenzierbare
Funktion dann heisst ein Punkt $x^*\in\mathbb{R}^n$, in dem alle
ersten partiellen Ableitungen
\begin{equation}
\frac{\partial f}{\partial x_k}(x^*) = 0
\end{equation}
verschwinden, ein {\em kritischer Punkt}.
\index{kritischer Punkt}
\end{definition}

Da der Gradient der Vektor der partiellen Ableitung ist, ist ein
kritischer Punkt auch eine Nullstelle des Gradienten $\grad f$.

\begin{satz}
Sei $f\colon\mathbb{R}^n\to\mathbb{R}$ eine stetig differenzierbare
Funktion.
Dafür, dass $f(x)$ im Punkt $x^*\in\mathbb{R}^n$ ein Minimum oder Maximum
annimmt, ist notwendig, dass $x^*$ ein kritischer Punkt ist.
\end{satz}

Um zu entscheiden, ob tatsächlich ein Minimum oder Maximum vorliegt,
sind wie im eindimensionalen Fall auch höhere Ableitungen zu berücksichtigen.
Da es viele höhere partielle Ableitungen gibt, werden die Bedingungen
jedoch deutlich komplizierter.
Die Matrix der zweiten Ableitungen wird im
Abschnitt~\ref{buch:fuvar:section:hessesche} genauer untersucht 
und ein hinreichendes Kriterium für Extrema hergeleitet.

%
% Das Fundamentallemma
%
\subsection{Das Fundamentallemma
\label{buch:fuvar:subsection:fundamentallemma}}
Extrema einer Funktion $f(x)$ werden bei kritischen Punkten $x_*$
gefunden, die Nullstellen der Richtungsableitungen
\[
D_vf(x_*)
=
\frac{d}{d\varepsilon}
f(x_*+\varepsilon v)
\bigg|_{\varepsilon =0}
\]
sind.
Da die Richtungsableitung auch als Skalarprodukt
\[
D_vf(x_*)
=
v
\cdot 
\operatorname{grad}f(x_*)
\]
mit dem Gradienten geschrieben werden kann, ist ein kritischer
Punkt auch dadurch charakterisiert, dass
\[
v\cdot \operatorname{grad}f(x_*)
=
0
\]
für alle $v$ ist.
In endlichdimensionalen Vektorräumen impliziert dies sofort,
dass alle Komponenten
\[
0
=
e_i\cdot \operatorname{grad}
=
(\operatorname{grad}f(x_*))_i
=
\frac{\partial f}{\partial x_i}(x_*)
\]
verschwinden müssen.
Wir halten diese Eigenschaft als Vorbereitung für die Entwicklungen
von Abschnitt~\ref{buch:variation:section:fundamentallemma}
als das Fundamentallemma für endlichdimensionale Vektorräume
fest.

\begin{satz}[Fundamentallemma für endlichdimensionale Vektorräume]
Wenn ein Vektor $u\in \mathbb{R}^n$ die Bedingung
\[
v \cdot u=0
\]
für alle Vektor $v\in\mathbb{R}^n$ ist, dann ist $u=0$.
\end{satz}

%
% Rand
%
\subsection{Rand}
Bisher wurde angenommen, dass die Funktion auf ganz $\mathbb{R}^n$
definiert ist.
Auch für eine Funktion einer Variablen, die nur auf einem Intervall
$[a,b]$ definiert ist, müssen die Randpunkte des Intervalls als
zusätzliche Kandidaten für Extrema in Betracht gezogen werden.
Falls $f'(a)>0$ ist, liegt in $a$ ein lokales Minimum vor, für
$f'(b)<0$ ein lokales Maximum in $b$.

Die analoge Situation für eine Funktion von $n$ Variablen ist der
Definitionsbereich $\Omega=\{x\in \mathbb{R}\mid x_1\ge 0\}$.
Zusätzlich zu den kritischen Punkten im Inneren von $\Omega$ sind die
Randpunkte $x_1=0$ gesondert zu untersuchen.
Eine notwendige Bedingung für ein Maximum oder Minimum der Funktion
$f\colon \Omega\to\mathbb{R}$ auf dem Rand ist dann, dass die Einschränkung
\[
f_{|\partial \Omega}
\colon
\mathbb{R}^{n-1}\to \mathbb{R}
:
(x_2,\dots,x_n)\mapsto f(0,x_2,\dots,x_n)
\]
auf den Rand einen kritischen Punkt hat.
Es müssen also alle partiellen Ableitungen
\[
\frac{\partial f}{\partial x_k}(0,x_2,\dots,x_n)
=
0,\qquad k=2,\dots,n,
\]
nach den Variablen
$x_2,\dots,x_n$ verschwinden.

Sei jetzt $\Omega$ ein Halbraum, der durch eine Hyperebene mit der Gleichung
\[
\vec{n}\cdot (x-x_0) = 0
\]
in Normalenform mit der Normalen $\vec{n}$ berandet ist.
Zusätzlich zu den inneren kritischen Punkten sind weitere Kandidaten
für lokale Extrema Punkte, in denen die Richtungsableitung für alle
Richtungen parallel zur Randebene verschwindet.
Ist also $\vec{v}\cdot \vec{n}$, dann muss
\[
D_{\vec{v}} f(x_0)
=
\frac{d}{\partial t}f(x_0+\vec{v})\bigg|_{t=0}
=
\grad f(x_0)\cdot \vec{v}
=
0
\]
erfüllt sein.
Dies ist gleichbedeutend damit, dass der Gradient $\grad f(x_0)$ parallel
zur Normalen $\vec{n}$ ist.

\begin{satz}
Dafür, dass eine stetig differenzierbare Funktion auf dem Halbraum
$D=\{x\in\mathbb{R}^n\mid (x-x_0)\cdot\vec{n}\le 0\}$ ein lokales 
Extremum im Punkt $x_0$ auf dem Rand von $D$ hat, ist notwendig,
dass $\grad f(x_0)=0$ ist oder dass $\grad f(x_0)$ senkrecht auf der Tangentialebene auf dem Rand ist.
\end{satz}

Dieser Satz ist nur ein Spezialfall der im nächsten
Abschnitt~\ref{buch:fuvar:section:nebenbedingungen}
untersuchten Methode zur Bestimmung von Extrema mit Nebenbedingungen.
Die Bedingung, dass der Punkt $x_0$ auf dem Rand liegt, kann man
als Nebenbedingung $g(x) = 0$ mit $g(x)=(x-x_0)\cdot\vec{n}$ betrachten.

