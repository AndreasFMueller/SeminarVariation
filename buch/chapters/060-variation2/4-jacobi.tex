%
% 4-jacobi.tex
%
% (c) 2024 Prof Dr Andreas Müller
%
\section{Das Jacobi-Kriterium
\label{buch:variation2:section:jacobi}}
\kopfrechts{Das Jacobi-Kriterium}
Die zweite Variation in der Form
\eqref{buch:variation2:zweitevariation:eqn:SRintegral}
zeigt, dass es für die Beurteilung, ob tatsächlich ein Extremum 
vorliegt, auf das Verhalten der Funktionen $S(x)$  und $R(x)$ ankommt.
In einem Minimum garantiert die Legendre-Bedingung bereits,
dass $R(x)\ge 0$ ist.
Es bleibt noch zu untersuchen, ob sich Bedinungen an die Funktion
$S(x)$ finden lassen, die garantieren können, dass ein Minimum
vorliegt.

%
% \delta^2 I(y)\ge 0 als Variationsproblem
%
\subsection{$\delta^2 I(y)\ge 0$ als Variationsproblem
\label{buch:variation2:jacobi:subsection:delta2I}}
Wir möchten herausfinden, ob die zweite Variation negativ werden kann.
Falls ja müsste sich eine Funktion $\eta(x)$ finden lassen, für die
der Wert des Integrals
\eqref{buch:variation2:zweitevariation:eqn:SRintegral}
negativ ist.
Ob es so eine Funktion gibt könnten wir dadurch entscheiden, dass wir
das Minimum des Integrals
\eqref{buch:variation2:zweitevariation:eqn:SRintegral}
suchen.
Damit ist ein Variationsproblem entstanden, auf das wir wieder die
bereits entwickelte Theorie anwenden können.

Zur Lösung des Variationsproblems scheiben wir $u(x)$ für die gesuchte
Variationsfunktion $\eta(x)$ und betrachten das Funktional
\begin{equation}
K(u)
=
\int_{x_0}^{x_1}
S(x) u(x)^2 + R(x) u'(x)^2
\,dx
\label{buch:variation2:jacobi:eqn:K}
\end{equation}
mit Randbedingungen $u(x_0)=u(x_1)=0$ und versuchen das Minimum
zu bestimmen.
Für $u(x)=0$ ist $K(0)=0$.
Sollte es aber Funktionen $u(x)$ geben, die $K(u)$ negativ machen,
dann kann die Funktion $y(x)$ von der ausgehen die Funktionen $S(x)$
und $R(x)$ konstruiert wurden, kein Minimum sein.

%
% Die Jacobi-Differentialgleichung
%
\subsubsection{Die Jacobi-Differentialgleichung}
Das Funktional
\eqref{buch:variation2:jacobi:eqn:K}
hat die Lagrange-Funk\-tion 
\[
G(x,u,u') = S(x) u^2 + R(x) u^{\prime 2}
\]
mit den Ableitungen
\begin{align*}
\frac{\partial G}{\partial u}
&=
2S(x) u
&
\frac{\partial G}{\partial u'}
&=
2R(x) u'.
\end{align*}
Daraus ergibt sich die Euler-Lagrange-Differentialgleichung
\[
2S(x) u(x) - 2\frac{d}{dx} R(x) u'(x) = 0.
\]
Der gemeinsame Faktor $2$ kann weggelassen werden.
Ausserdem ist es üblich, die Differentialgleichung mit umgekehrtem
Vorzeichen hinzuschreiben, also als
\begin{equation}
\frac{d}{dx} R(x)\frac{d}{dx} u(x) - S(x) u(x) = 0.
\label{buch:variation2:jacobi:eqn:jacobisl}
\end{equation}
Dies ist eine lineare Differentialgleichung zweiter Ordnung für die Funktion
$u(x)$.

\begin{definition}[Jacobi-Differentialgleichung]
Die Differentialgleichung
\eqref{buch:variation2:jacobi:eqn:jacobisl}
heisst die {\em Jacobi-Differentialgleichung}
für die Extermale $y(x)$.
\end{definition}

\subsection{Nullstellen von Lösungen der Jacobi-Differentialgleichung
\label{buch:variation2:jacobi:subection:nullstellen}}
Die Jacobi-Differentialgleichung ist nahe an der Form einer
Sturm-Liouville-Differential\-gleichung,
wie sie in Abschnitt~\ref{buch:variation2:section:diffgl} genauer
untersucht wurde.
Insbesondere wurden dort Aussagen über die Lage der Nullstellen von
Lösungen gefunden, die weiter unten nützlich sein werden.

%
% Die starke Legendre-Bedingung
%
\subsubsection{Die starke Legendre-Bedingung}
Durchführung der Ableitung im ersten Term der Jacobi-Differentialgleichung
führt auf
\[
R(x) u''(x) + R'(x) u'(x) - S(x) u(x) = 0,
\]
während eine Sturm-Liouville-Differentialgleichung bei $u''(x)$ den
Koeffizienten $1$ hat.
Die Form einer Sturm-Liouville-Differentialgleichung kann erreicht
werden, wenn $R(x)>0$ ist, denn in diesem Fall kann man die
Differentialgleichung durch $R(x)$ dividieren und die Gleichung
\[
u''(x) + \frac{R'(x)}{R(x)} u'(x) -\frac{S(x)}{R(x)} u(x) = 0
\]
erhalten.

\begin{definition}[Starke Legendre-Bedingung]
Die Lagrange-Funktion $F(x,y,y')$ erfüllt die starke Legendre-Bedingung
für die Extremale $y(x)$, wenn gilt
\[
\frac{\partial^2 F}{\partial y^{\prime 2}}(x,y(x),y'(x)) > 0
\]
für alle $x\in [x_0,x_1]$.
\end{definition}

Unter der Voraussetzung der starken Legendre-Bedingung ist die
Jacobi-Differential\-glei\-chung also äquivalent zu einer
Sturm-Liouville-Differentialgleichung.
In Abschnitt~\ref{buch:variation2:section:diffgl}
wurde die die Vorzeichen und Nullstellen der Lösungen einer solchen
Gleichung untersucht.
Diese Eigenschaften gelten daher auch für die Jacobi-Differentialgleichung.

%
% Berechnung von K(u) aus L(u)
%
\subsubsection{Berechnung von $K(u)$ aus $L(u)$}
Wir schreiben die linke Seite der Jacobi-Differentialgleichung auch
in der Form
\begin{equation}
L(u)
=
\frac{d}{dx}\frac{\partial G}{\partial y'}
-
\frac{\partial G}{\partial y}
=
\frac{d}{dx}(Ru') 
-
Su.
\label{buch:variation2:jacobi:eqn:L}
\end{equation}
Falls die Funktion $u(x)$, die keine Lösung der Jacobi-Differentialgleichung
zu sein braucht, die Randbedingungen $u(x_0)=u(x_1)=0$ erfüllt,
kann das Integral
\begin{align}
\int_{x_0}^{x_1} u(x) L(u(x)) \,dx
&=
\int_{x_0}^{x_1} u(x)
\biggl(
\frac{d}{dx}\bigl(R(x)u'(x)\bigr) 
-
S(x) u(x)
\biggr)
\,dx
\notag
\intertext{mit partieller Integration im ersten Term berechnet werden.
Es ergibt}
&=
\biggl[
u(x)R(x)u'(x)
\biggr]_{x_0}^{x_1}
-
\int_{x_0}^{x_1}
u'(x) \bigl( R(x)u'(x) \bigr)
+
u(x) S(x) u(x)
\,dx.
\notag
\intertext{Der erste Term verschwindet wegen der Randbedingung, der
Rest kann zu}
&=
-
\int_{x_0}^{x_1} R(x) u'(x)^2 + S(x) u(x)^2 \,dx
=
- K(u).
\label{buch:variation2:jacobi:eqn:LK}
\end{align}
vereinfacht werden.
Das Funktional $K(u)$ kann also mit der linken Seite der
Jacobi-Diffe\-ren\-tial\-gleichung ausgedrückt werden.

%
% Nullstellen im Inneren von [x_0,x_1]
%
\subsubsection{Nullstellen im Inneren von $[x_0,x_1]$}
\input{chapters/060-variation2/fig/xstern.tex}
Auf die Jacobi-Differentialgleichung sind wir gestossen, weil wir nach
Variationsfunktionen $\eta$ gesucht haben, die die zweite Variation
negativ machen könnten.
Unter der Voraussetzung der starken Legendre-Bedingung sind den
Nullstellen einer Lösung starke Einschränkungen auferlegt.
Sei also $u_0(x)$ eine Lösung der Jacobi-Differentialgleichung mit den
Anfangsbedingungen
\[
u_0(x_0) = 0
\qquad\text{und}\qquad
u_0'(x_0) = 1
\]
und sei $x_*$ die kleinste, von $x_0$ verschiedene Nullstelle von $u_0(x)$
im Inneren von $[x_0,x_1]$.
Insbesondere ist $u_0(x)>0$ im Teilintervall $(x_0,x_*)$.

Aus der Funktion $u_0(x)$ konstruieren wir jetzt eine neue Funktion
\[
u_1(x)
=
\begin{cases}
u_0(x) &\qquad \text{für $x\in [x_0,x_*]$}\\
0      &\qquad \text{sonst.}
\end{cases}
\]
Diese Funktion ist stetig, aber nicht differenzierbar an der Stelle
$x_*$.
Sie erfüllt aber die Randbedingungen $u_1(x_0)=u_1(x_1)=0$, so dass
\eqref{buch:variation2:jacobi:eqn:LK}
zur Berechnung von $K(u_1)$ verwendet werden kann.
Insbesondere gilt
\[
K(u_1)
=
-
\int_{x_0}^{x_*}
u_0
\underbrace{L(u_0)}_{\displaystyle=0}
\,dx
-
\int_{x_*}^{x_1}
0
\cdot L(0)
\,dx
=
0.
\]

Die Funktion $u_1$ ist aber an der Stelle $x_*$ nicht differenzierbar,
sie kann also nur dann ein Extremum sein, wenn sie an der Stelle
$x_*$ die weierstrasse-erdmannsche Eckenbedingung erfüllt.

Die Eckenbedingung von
Satz~\ref{buch:nichtdiff:splines:satz:weierstrass-erdmann}
sagt, dass die Ableitung die Funktionen
\[
\frac{\partial G}{\partial u'}(x,u(x),u'(x))
\qquad\text{und}\qquad
G(x,u(x),u'(x))
-
u'(x)\frac{\partial G}{\partial u'}(x,u(x),u'(x))
\]
stetige Funktionen sein müssen.
Für die Lagrange-Funktion $G$ sind dies die Funktionen
\[
2R(x) u'(x)
\qquad\text{und}\qquad
S(x)u(x)^2 + R(x)u'(x)^2 - u'(x) 2R(x)u'(x)
=
S(x)u(x)^2-R(x)u'(x)^2.
\]
Die Funktion $u_1'(x)$ ist an der Stelle $x_*$ nicht stetig, denn da
$u_0(x)$ eine Lösung der Jacobi-Differentialgleichung ist, hat sie nur
einfache Nullstellen.
Die Steigung $u'_0(x_*)$ muss also an der Nullstelle $x_*$ von 
$0$ verschieden sein.
Die Funktionen $u(x)$ und $S(x)$ sind stetig und $R(x)$ is stetig
und an der Stelle $x_*$ von $0$ verschieden,
daher sind beide Eckenbedingungen verletzt.

Da die Eckenbedingung nicht erfüllt ist, kann $u_1(x)$ dem Funktional
$K(u)$ nicht ein Minimum erteilen.
Da aber $K(u_1)=0$ ist, muss es auch Funktionen $u(x)$ mit Randbedingungen
$u(x_0)=u(x_1)=0$ geben, für die $K(u)<0$ negative Werte annimmt.
Wenn aber die zweite Variation $\delta^2I(y)=K(u)<0$ ist, kann $y(x)$
nicht ein Minimum sein.

\begin{satz}
Erfüllt die Extremale $y(x)$ die starke Legendre-Bedingung und hat
die Lösung $u_0(x)$ der Jacobi-Differentialgleichung mit Anfangsbedingung
$u_0(x_0)=0$ und $u_0'(x_1)=1$ eine Nullstelle im Inneren des Intervalls
$[x_1,x_2]$, dann ist $I(y)$ kein Minimum.
\end{satz}

%
% Konjugierte Punkte
%
\subsubsection{Konjugierte Punkte}
\input{chapters/060-variation2/fig/jacobi.tex}
Das durch Nullstellen einer Lösung $u_0(x)$ im Inneren des Intervalls
verursachte Phänomen kann sehr schön am Beispiel der kürzesten
Verbindung auf einer Kugeloberfläche illustriert werden.
Die kürzesten Verbindung zweier Punkte ist dort immer ein Grosskreisbogen.
Liegen die Punkte auf dem Äquator, dann liegt in Normalfall auch die
kürzeste Verbindung auf dem Äquator.

Seien jetzt $x_0$ und $x_1$ die geographische Länge von zwei Punkten
auf dem Äquator, zwischen denen die kürzeste Verbindung gesucht wird.
In Abbildung~\ref{buch:variation2:fig:jacobi} sind die möglichen
Situationen illustriert.
In a) ist das Intervall $|x_1-x_0|<\pi$, in diesem Fall ist die
das Intervall $[x_0,x_1]$ die kürzeste Verbindung und die 
Jacobi-Differentialgleichung hat keine Nullstellen im Inneren 
dieses Intervalls.

In c) ist das Intervall $|x_1-x_0|>\pi$, in diesem Fall ist das Intervall
$[x_0,x_1]$ die längste Verbindung.
Die Lösung $u_0(x)$ Jacbi-Differentialgleichung hat eine Nullstelle
bei $x_*=x_0+\pi$.
Mit dem Bogen in der oberen Halbkugel zwischen $x_0$ und $x_*$
gefolgt vom Äquatorabschnitt von $x_*$ bis $x_1$ kann man eine
alternative Verbindung herstellen, die zwar die gleiche Länge hat,
die aber durch Abrundung der Ecke bei $x_*$ verkürzt werden kann.
Dies ist die Erkenntnis aus der weierstrass-erdmannschen
Eckenbedingung für $u_1(x)$.
Die kürzeste Verbindung ist der komplementäre, rot eingezeichnete
Teil des Äquators.

In b) ist $x_1=x_0+\pi$.
In diesem Fall ist $u_0(x)$ eine Lösung, die die Randbedingung
$u_0(x_0)=u_0(x_1)=0$ erfüllt, sie kann also als Variation
für das ursprüngliche Integral verwendet werden.
Die variierten Lösungen sind alle rot eingezeichnet und haben,
da $u_0(x)$ die Jacobi-Differentialgleichung erfüllt, die gleiche
Länge.

Die Punkte $x_0$ und $x_*$ heissen {\em konjugierte} Punkte.
\index{konjugierter Punkt}%

%
% Lösungen ohne Nullstellen im Inneren
%
\subsection{Lösungen ohne Nullstellen im Inneren
\label{buch:variation2:jacobi:subsection:}}
Wir nehmen jetzt an, dass $y(x)$ die starke Legendre-Bedingung
erfüllt und die Lösung $u_0(x)$ der zugehörigen
Jacobi-Differentialgleichung mit Anfangsbedingungen $u_0(x_0)=0$
und $u_0'(x_0)=1$ keine Nullstellen im Inneren des Intervalls
$[x_0,x_1]$ hat.
Wir wollen zeigen, dass unter diesen Voraussetzungen die zweite
Variation nicht negativ sein kann.

Die zweite Variation ist das Integral
\begin{align*}
\delta^2 I(y)
&=
\int_{x_0}^{x_1}
S(x) \eta(x)^2 + R(x) \eta'(x)^2
\,dx.
\intertext{Da die starke Legendre-Bedingung gilt, ist $R(x)>0$ und
kann daher ausgeklammert werden:}
&=
\int_{x_0}^{x_1}
R(x)
\biggl(
\eta'(x)^2 + \frac{S(x)}{R(x)}\eta(x)^2
\biggr)
\,dx
\end{align*}
Wenn man zeigen kann, dass die Klammer im Integranden ein Quadrat
ist, dann folgt, dass das Integral $\ge 0$ sein muss.

Wir berechnen zu diesem Zweck das Integral
\begin{align}
J&=
\int_{x_0}^{x_1} 
R(x) 
\biggl(
\eta'(x)
-\frac{u_0'(x)}{u_0(x)} \eta(x)
\biggr)^2
\,dx
\label{buch:variation2:jacobi:eqn:Jquadrat}
\\
&=
\int_{x_0}^{x_1} 
R(x) 
\biggl(
\eta'(x)^2
-
2\frac{u_0'(x)}{u_0(x)} \eta(x) \eta'(x)
+\frac{u_0'(x)^2}{u_0(x)^2} \eta(x)^2
\biggr)
\,dx
\notag
\\
&=
\int_{x_0}^{x_1}
R(x)
\biggl(
\eta'(x)^2
-
\frac{u_0'(x)}{u_0(x)}(\eta(x)^2)'
+
\frac{u_0'(x)^2}{u_0(x)^2}
\eta(x)^2
\biggr)
\,dx.
\notag
\intertext{Durch partielle Integration im mittleren Term, bei der
$(\eta(x)^2)'$ aufgeleitet und $R(x)u_0'(x)/u_0(x)$ abgeleitet wird,
erhält man wegen der Randbedingung $\eta(x_0)=\eta(x_1)=0$}
&=
\int_{x_0}^{x_1}
R(x)\eta'(x)^2
+
\underbrace{
\biggl(
\biggl(R(x)\frac{u_0'(x)}{u_0(x)}\biggr)'
+
R(x)
\frac{u_0'(x)^2}{u_0(x)^2}
\biggr)
}_{\displaystyle =A}
\eta(x)^2
\,dx
\notag
\end{align}
In der
mit $A$ bezeichneten Klammer im Integranden berechnen wir die Ableitung
des ersten Terms mit der Produktregel für die Faktoren
\[
\biggl(
R(x)\frac{u_0'(x)}{u_0(x)}
\biggr)'
=
\biggl(
R(x)u_0'(x)
\cdot
\frac{1}{u_0(x)}
\biggr)'
=
(R(x)u_0(x))'\frac{1}{u_0(x)}
+
R(x)u_0(x)\biggl(\frac{1}{u_0(x)}\biggr)'
\]
und erhalten für
\begin{align*}
A
&=
\frac{1}{u_0(x)}
\frac{d}{dx} R(x) \frac{d}{dx}u_0(x)
+
R(x)u_0'(x)
\frac{d}{dx}\frac{1}{u_0(x)}
+
R(x)\frac{u_0'(x)^2}{u_0(x)^2}
\intertext{Da $u_0(x)$ eine Lösung der Jacobi-Differentialgleichung ist,
ist der erste Term $S(x)$ und damit}
A
&=
S(x)
-
R(x)u_0'(x)\frac{u_0'(x)}{u_0(x)^2}
+
R(x)\frac{u_0'(x)^2}{u_0(x)^2}
=
S(x).
\end{align*}
Eingesetzt im Integral erhalten wir
\[
J
=
\int_{x_0}^{x_1}
R(x)\eta'(x)^2 + S(x) \eta(x)^2
\,dx
=
\delta^2 I(y).
\]
Die zweite Variation kann also als das Integral $J$ geschrieben
werden.
Der Integrand von $J$ in der Form
\eqref{buch:variation2:jacobi:eqn:Jquadrat}
ist $\ge 0$, denn $R(x)>0$ wegen der starken Legendre-Bedingung 
und der zweite Faktor, die Klammer, ist ein Quadrat und daher
auch $\ge 0$.
Somit folgt $J\ge 0$.
Damit haben wir den folgenden Satz gezeigt.

\begin{satz}[Jacobi-Bedingung]
Erfüllt eine Extremale $y(x)$ des Funktionals $I(y)$ die starke
Legendre-Bedingung und hat die Lösung $u_0(x)$ der Jacobi-Differentialgleichung
mit Anfangswerten $u_0(x_0)=0$ und $u_0'(x_0)=1$ im Inneren des
Intervalls $[x_0,x_1]$ keine Nullstellen, dann ist
$\delta^2 I(y)\ge 0$.
\end{satz}




%
% Kürzeste Verbindung auf einem Rotationsellipsoid
%
\subsection{Kürzeste Verbindung auf einem Rotationsellipsoid}
Seit über 2000 Jahren ist der Menschheit bekannt, dass die Erde
ungefähr die Form einer Kugel hat.
Erathostenes gelang es als erstem, den Umfang der Erde mit
einem Fehler von weniger als $2\%$ zu bestimmen.
Die Entfernungsmessung auf einer Kugeloberfläche ist deutlich
komplizierter als auf einer Ebene.
Bereits im Altertum wurde die sphärische Trigonometrie entwickelt,
mit der sich Winkel und Seitenlägen von beliebigen Dreiecken auf
einer Kugeloberfläche berechnen lassen.
Van Brummelen \cite{buch:heavenly} gibt eine sorgfältige Einführung
in die Geschichte und die Anwendungen der sphärischen Geometrie.

\begin{beispiel}
Die kürzesten Verbindungen zweier Punkte auf einer Kugel ist ein
Grosskreis.
Liegen die Punkte weniger als $180^\circ$ Grad auseinander, gibt es
nur eine kürzeste Verbindung, das Längenfunktional nimmt ein
absolutes Minimum an.

Sind die Punkte jedoch Antipodenpunkte, dann gibt es unendliche viele
Grosskreise durch beide Punkte.
Das Längenfunktional hat kein absolutes Minimum mehr, die Drehung eines
Grosskreises um die Achse durch die beiden Punkte ist eine Variation,
die das Funktional nicht ändert.
Die beiden Punkte sind konjugierte Punkte.
\end{beispiel}

Die Erde ist aber nicht eine Kugel, sondern eher ein Rotationsellipsoid,
der Durchmesser entlang der Achse ist verschieden vom Durchmesser des 
Äquators.
Im 17. Jahrhundert gab es einen wissenschaftlichen Disput darüber,
ob der Durchmesser entlang der Achse kleiner oder grösser als der
Äquatordurchmesser ist.
Newton und Huygens hatten aufgrund der allgemeinen Mechanik eine Abplattung
der Erde vorhergesagt, die durch von Jean Richter und Philipp de La Hire
durch die erste Vermessung des Merdianbogens durch Paris bestätigt 
worden war.
Die Sache war aber immer noch nicht vollständig geklärt.
Der Astronom Jacques Cassini schloss zu Beginn des 18. Jahrhunderts,
dass der Polradius grösser als der Äquatorradius sein müsse.
König Ludwig XV.~beauftragte daher Maupertuis mit einer Expedition
nach Lappland.
Als Teil der Expedition soll der Abstand zweier Breitengrade
vermessen werden.
Wenn der Radius im hohen Norden zunehmen abnimmt, wird auch die Länge
eines Merdianbogens zu vorgegebenem Winkel kürzer.
Die Expedition von Maupertuis und eine zeitgleich stattfindende Expedtion
nach Ecuador bestätigten beide die Abplattung.

\begin{beispiel}
Unter der Annahme, dass die Erde ein Rotationsellipsoid mit Äquatorradius
$1$ und Polradius $r$ ist, soll der kürzeste Weg zwischen zwei Punkten
auf dem Äquator bestimmt werden.
\end{beispiel}



