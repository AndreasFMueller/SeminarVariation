%
% einleitung.tex -- Beispiel-File für die Einleitung
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
% !TEX root = ../../buch.tex
% !TEX encoding = UTF-8
%
\section{Luke's Lagrangian\label{luke:section:Luke_Lagrangian}}
\rhead{Luke's Lagrangian}

1967 veröffentlichte J.C. Luke \cite{luke:Luke1967} den Luke`s Lagrangian mit welchem über das Variationsprinzip die Bewegungen von Oberflächenwellen auf einer freien Fluid Oberfläche unter Einwirkung der Schwerkraft berechnet werden kann.
Genau gesagt lässt sich durch die Minimierung des Lagrangian über das Variationsprinzip, Gleichungen für Oberflächengravitationswellen eines inkompressibles, nicht viskosen, rotationsfreien Potentialflusses mit einer undurchlässigen freien Oberfläche sowie Boden, bei konstanten Druck, herleiten.

Die Formel \eqref{luke:Luke_Variation_Formel} zeigt Luke´s Variationsformel in welcher Luke´s Lagrange-Funktion \eqref{luke:Luke_Lagrangian_Allgemein} vorkommt.

\begin{equation}
	I(\phi)
	=
	- \int_{t_0}^{t_1} \iint_{\Omega}^{} \int_{z_0}^{z_1}\left[
	g z + \phi_t + \frac{1}{2}(\nabla\phi)^2 + \frac{1}{2}\phi_z^2
	\right] dzdydxdt
	\label{luke:Luke_Variation_Formel}
\end{equation}

\begin{equation}
	L(x,y,z,t,\eta,h,\phi,\phi_t,\phi_x, \phi_y, \phi_z)
	=
	-\int_{z_0}^{z_1} g z + \phi_t + \frac{1}{2}(\nabla\phi)^2 + \frac{1}{2}\phi_z^2 dz
		\label{luke:Luke_Lagrangian_Allgemein}
\end{equation}
Wobei für $z_0$ der Gewässergrund $-h(\bm{x},t)$ und für $z_1$ die freie Oberfläche der Flüssigkeit $\eta(\bm{x},t)$ eingesetzt wird:
\[
=
-\int_{-h(\bm{x},t)}^{\eta(\bm{x},t)} 
g z + \phi_t + \frac{1}{2}(\nabla\phi)^2 + \frac{1}{2}\phi_z^2
\]

\begin{itemize}
	\item
	$\phi(\bm{x},z,t)$ ist das Geschwindigkeitspotential
	\item
	$\rho$ Dichte der Flüssigkeit
	\item
	$g$ Erdbeschleunigung
	\item
	$t$ Zeit
	\item 
	$\bm{x}$ horizontale Koordinatenvektor mit $x$ und $y$ als Komponenten
	\item 
	$z$ vertikale Koordinate
	\item 
	$\Omega$ Interval über die horizontale Koordinate $[x_0,x_1]\times[y_0,y_1]$
	\item 
	$\nabla$ horizontaler Gradient wobei der Term $(\nabla \phi)^2 = \phi_x^2+\phi_y^2$
	\item 
	$\eta(\bm{x},t)$ freie Oberfläche der Flüssigkeit
	\item 
	$h(\bm{x},t)$ Gewässergrund 
	
\end{itemize}
%DIESER TEIL EINBAUEN (Rotations und inlompressiblen Strömung)
Luke`s Lagrangian setzt vorraus das es sich um eine rotationsfreie und  inkompressiblen Strömung handelt.
Das bedeutet das folgende zusammenhänge erfüllt werden müssen:
\[
\text{horizontale Geschwindikeit}\quad \bm{u}(\bm{x},t) = \nabla \phi (\bm{x}, y, t) = \left(\phi_x, \phi_y\right)
\]
\[
\text{Rotationsfreiheit:}\quad \nabla \times \bm{u}(\bm{x},t) = 0
\]
\[
\text{Inkompressiblen Strömung:}\quad \nabla \cdot \bm{u}(\bm{x},t) = \nabla \cdot \nabla \phi(\bm{x}, z, t) = \triangle \cdot \phi(\bm{x}, z, t) = 0
\]

\subsection{Erweitern des Luke`s Lagrangian
	\label{luke:subsection:Erweitern}}

Durch das erweitern der Lagrange-Funktion, wird der Freiheitsgrad erhöht, was bei der Variation ermöglicht eine größere Vielfalt von Ansätze zu realisieren.
Somit können Effekte berücksichtigt werden, welche in der realen Welt auftreten können. Dies kann zu genaueren Gleichungssystemen für Wasserwelle führen.

Zuest wird im sinne der Vereinfachung die Oberflächenspannung vernachlässigt sowie die Flüssigkeitsdichte $\rho$ konstant auf $\rho = 1\frac{g}{ml}$ gesetzt.
Das entspricht der Dichte von Wasser und sollte somit nicht die weiteren Berechnungen beeinflussen.
Das Integral \eqref{luke:Luke_Lagrangian_Allgemein} kann umgeschrieben und teilweise Integriert werden.
\[
L(x,y,z,t,\eta,h,\phi,\phi_t,\phi_x, \phi_y, \phi_z)
=
-\int_{-h(\bm{x},t)}^{\eta(\bm{x},t)} g z\, dz - \int_{-h(\bm{x},t)}^{\eta(\bm{x},t)} \phi_t\, dz -\int_{-h(\bm{x},t)}^{\eta(\bm{x},t)} \frac{1}{2}\left(\nabla\phi\right)^2 + \frac{1}{2}\phi_z^2 dz
\]
\[
=
-\frac{1}{2}g\eta(\bm{x},t)^2 + \frac{1}{2}h(\bm{x},t)^2g +\tilde{\phi} \frac{\partial\eta(\bm{x},t)}{\partial t} + \check{\phi} \frac{\partial h(\bm{x},t)}{\partial t} -\int_{-h(\bm{x},t)}^{\eta(\bm{x},t)} \frac{1}{2}\left(\nabla\phi\right)^2 + \frac{1}{2}\phi_z^2 dz
\]
Dabei ist $\tilde{\phi} = \phi(\bm{x},\eta(\bm{x},t),t)$ das Geschwindigkeitspotential auf der Oberfläche und $\check{\phi} = \phi(\bm{x},-h(\bm{x},t),t)$ das Geschwindigkeitspotential am Gewässergrund.
Beim Variationsprinziep wird die Veränderung der Funktion unter Variation ihrer Parameter betrachtet.
Um die Berechnungen zu erleichtern wird angenommen, dass sich der Gewässergrund Zeitlich nicht ändert und die Tiefe konstant bleibt, somit ist $h(\bm{x},t) = h$ und $\frac{\partial h}{\partial t} = 0$.
Weil die Tiefe $h$ als konstant angenommen wird, verändert diese sich nicht während des Minimierungsprozesses.
Daher hat dieser Term $\frac{1}{2}h^2g$ keinen Einfluss auf die Variation und kann weggelassen werden.
Somit kann die Lagrange-Funktion angeschrieben werden als:
\[
L(x,y,z,t,\eta,\phi,\phi_t,\phi_x, \phi_y, \phi_z)
=
-\frac{1}{2}g\eta(\bm{x},t)^2 +\tilde{\phi} \frac{\partial\eta(\bm{x},t)}{\partial t} -\int_{-h}^{\eta(\bm{x},t)} \frac{1}{2}\left(\nabla\phi\right)^2 + \frac{1}{2}\phi_z^2 dz
\]
Um denn Freiheitsgrad der Variation zu erhöhen, wird die horizontale Geschwindikeit $\bm{u}(\bm{x},z,t) = \nabla\phi = \left(\phi_x, \phi_y\right)$ und die vertikale Geschwindigkeit $v(\bm{x},z,t) = \phi_z$ eingeführt. 
Dadurch das wir die Lagrange-Funktion erweitern müssen wir auch der Zusammenhang von horizontalen und vertikalen Geschwindigkeit mit dem Geschwindigkeitspotential als Nebenbedingung einsetzten.
Somit bekommen wir folgende Nebenbedingungen:
\[
\bm{u}(\bm{x},z,t)
=
\nabla\phi
\quad\Rightarrow\quad
\bm{u}(\bm{x},z,t)
-
\nabla\phi
=
0,
\]
\[
v(\bm{x},z,t)
=
\phi_z
\quad\Rightarrow\quad
v(\bm{x},z,t)
-
\phi_z
=
0.
\]
Zwei Nebendedingungen bedeuten das einfügen von zwei Lagrange-Multiplikatoren.
Wobei $\bm{\mu}(\bm{x},z,t)$ für die erste und $\upsilon(\bm{x},z,t)$ für die zweite Nebenbedingung eingesetzt wird.
Somit wird die Lagrange-Funktion erweitert mit den Multiplikatoren und Nebenbedingungen.
\[
L(x,y,z,t,\eta,\phi,\bm{u}, v, \bm{\mu},\upsilon,\phi_t,\phi_x,\phi_y,\phi_z)
=
\]
\begin{equation}
	-
	\frac{1}{2} g \eta(\bm{x},t)^2
	+
	\widetilde{\phi} \frac{\partial\eta(\bm{x},t)}{\partial t}
	-
	\int_{-h}^{\eta(\bm{x},t)} \left[ \frac{1}{2} (\bm{u}^2 + v^2) + \bm{\mu} (\nabla\phi - \bm{u}) + \upsilon  \left(\phi_z - v\right) \right] dz
	\label{luke:Luke_Lagrangian_mit_Multi}
\end{equation}
Die Multiplikatoren lassen sich über das Variationsprinzip bestimmen.
Die Bestimmung der Multiplikatoren kann schon vor konkreter Berechnung, ohne einem Ansatz, durchgeführt werden.
Dafür betrachten wir die Variation der Lagrangefunktion \eqref{luke:Luke_Lagrangian_mit_Multi} bezogen auf die Geschwindigkeiten $\bm{u}$ und $v$.
Die Variation von $L$ nach $\bm{u}$ und $v$ ergibt folgende Euler-Lagrange-Gleichungen:

\[
\frac{\partial L}{\partial \bm{u}} = 0
\]
\[
\frac{\partial L}{\partial v} = 0	
\]
Das lösen der Variation nach $\bm{u}$ ergibt:
\[
 = \frac{\partial \mathscr{}}{\partial \bm{u}}\left( -\frac{1}{2} g \eta(\bm{x},t)^2 + \widetilde{\phi} \frac{\partial\eta(\bm{x},t)}{\partial t} - \int_{-h}^{\eta(\bm{x},t)} \left[ \frac{1}{2} (\bm{u}^2 + v^2) + \bm{\mu} (\nabla\phi - \bm{u}) + \upsilon \left(\phi_z - v\right) \right] dz\right)
 = 0.
\]
Das Integral kann weggelassen werden sowie die Therme davor ergeben null.
\[
= -\frac{\partial}{\partial \bm{u}} \left(\frac{1}{2} (\bm{u}^2 + v^2) + \bm{\mu} (\nabla\phi - \bm{u}) + \upsilon \left(\phi_z - v\right) \right) = 0
\]
\[
= -\frac{\partial}{\partial \bm{u}} \left( \frac{1}{2} (\bm{u}^2 + v^2) \right)  -\frac{\partial}{\partial \bm{u}} \left( \bm{\mu} (\nabla\phi - \bm{u}) \right)  -\frac{\partial}{\partial \bm{u}} \left( \upsilon \left(\phi_z - v\right) \right) = 0
\]
\[
=
-\bm{u}
+\bm{\mu}
= 0
\]
Somit erhalten wir:
\begin{equation}
	\bm{u}(\bm{x},z,t) = \bm{\mu}(\bm{x},z,t).
\end{equation}
Das gleiche wird mit der Variation nach $v$ gemacht und ergibt:
\begin{equation}
	v(\bm{x},z,t) = \upsilon(\bm{x},z,t).
\end{equation}
Diese Erkenntnis kann wiederum in \eqref{luke:Luke_Lagrangian_mit_Multi} eingesetzt werden.
Damit ergibt sich folgende Lagrangefunktion:
\[
L(x,y,z,t,\eta,\phi,\bm{u}, v,\phi_t,\phi_x, \phi_y, \phi_z)
=
\]
\begin{equation}
	-
	\frac{1}{2} g \eta(\bm{x},t)^2
	+
	\widetilde{\phi} \frac{\partial\eta(\bm{x},t)}{\partial t}
	+
	\int_{-h}^{\eta(\bm{x},t)} \left[ \frac{1}{2} \bm{u}^2 + \frac{1}{2} v^2 - \bm{u} \nabla \phi - v \phi_z \right] dz 
	\label{luke:Luke_Lagrangian_mit_Multi_verkuerzt}
\end{equation}
Somit haben wir drei Lagrange-Funktionen mit unterschiedlich vielen Variablen.
Die Ursprüngliche Luke`s Lagrangian \eqref{luke:Luke_Lagrangian_Allgemein} hat die Variablen $(x,y,z,t,\eta,\phi)$.
Die angepasste Funktion mit den Lagrange-Multiplikatoren \eqref{luke:Luke_Lagrangian_mit_Multi} hat vier Variablen mehr $(x,y,z,t,\eta,\phi,\bm{u},v,\bm{\mu},\upsilon)$ und die vereinfachte Form davon \eqref{luke:Luke_Lagrangian_mit_Multi_verkuerzt} hat zwei Variablen mehr $(x,y,z,t,\eta,\phi,\bm{u},v)$.
Diese zusätzlichen Variablen bringen zusätzliche Freiheitsgrade.
Damit kann bei der Konstruktion von Lösungen für verschiedener Oberflächenwasserwellen mehrere untergeordnete Beziehungen erfüllt werden.

Die Lagrange-Funktion \eqref{luke:Luke_Lagrangian_mit_Multi} kann mittels Green Theorem umgeformt werden auf eine Formulierung welche mehr der klassischen Mechanik entspricht.
\[
L(x,y,z,t,\eta,\phi,\bm{u}, v, \bm{\mu},\upsilon,\phi_t,\phi_x,\phi_y,\phi_z)
=
\]
\[
\left(\frac{\partial \eta(\bm{x},t)}{\partial t}
+
\widetilde{\bm{\mu}} \nabla \eta(\bm{x},t)
-
\widetilde{\upsilon}\right) \widetilde{\phi}
-
\frac{1}{2} g \eta(\bm{x},t)^2
\]
\begin{equation}
	+
	\int_{-h}^{\eta(\bm{x},t)} \left[ \bm{\mu}  \bm{u} - \frac{1}{2} \bm{u}^2 + \upsilon v - \frac{1}{2} v^2 + \left(\nabla \bm{\mu} + \frac{\partial \upsilon}{\partial z}\right) \phi \right] dz
	\label{luke:Luke_Lagrangian_umgeschrieben}
\end{equation}
wobei $\tilde{\mu} = \mu(\bm{x},\eta(\bm{x},t),t)$ und $\tilde{\upsilon} = \upsilon(\bm{x},\eta(\bm{x},t),t)$ die Lagrange-Multiplikatoren auf der Wasseroberfläche sind.
Der Lagrangian \eqref{luke:Luke_Lagrangian_umgeschrieben} beinhaltet die kinetische Energie minus der potenziellen Energie plus der Bedingungen für rotationsfreie und inkompressiblen Strömung sowie die Bedingung der Undurchlässigkeit für Oberflächen.
Diese Anordnung der Lagrange-Funktion ergibt das Hamiltonsche Prinzip in seiner allgemeinsten Form für rotationsfreie Oberflächengravitationswellen.

Bevor wir zu den Variationen der Lagrange-Funktion kommen wird noch folgende Formulierung zur Vereinfachung der Nachfolgenden Schritte eingeführt.
Alle Variablen welche mit einem Balken gekennzeichnet sind, sind über die Wassertiefe gemittelte Werte. Diese sind folgend definiert:

\begin{equation}
	\overline{\bm{u}}(\bm{x}, t) \equiv \frac{1}{\eta(\bm{x}, t) + h} \int_{-h}^{\eta(\bm{x},t)} \bm{u}(\bm{x},z,t) \, dz.
	\label{luke:Mittelung_Wassertiefe}
\end{equation}
Zu beachten ist, dass die über die Wassertiefe gemittelte Variable nicht mehr von der vertikalen Achse $z$ abhängt.

